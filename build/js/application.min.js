function google_map(){function e(){geocoder=new google.maps.Geocoder,map=new google.maps.Map(document.getElementById("map"),{zoom:7,center:new google.maps.LatLng(54.559322,-4.174804),mapTypeId:google.maps.MapTypeId.TERRAIN});var e=document.createElement("script");e.src="assets/data/cinemas.geojsonp",document.getElementsByTagName("head")[0].appendChild(e)}window.cinemalist_callback=function(e){for(var o=0;o<e.cinemas.length;o++){var a=(e.cinemas[o].geometry.coordinates,e.cinemas[o].properties.icon);geocoder.geocode({address:e.cinemas[o].properties.postcode},function(e,o){if(o==google.maps.GeocoderStatus.OK){var n=e[0].geometry.location;new google.maps.Marker({position:n,icon:a,map:map})}else alert("Geocode was not successful for the following reason: "+o)})}},google.maps.event.addDomListener(window,"load",e)}function convertAddress(){$(".map-form").fadeOut(400);var e=document.getElementById("address").value;geocoder.geocode({address:e},function(e,o){o==google.maps.GeocoderStatus.OK?(map.setCenter(e[0].geometry.location),map.setZoom(12),"undefined"!=typeof customerMarker&&customerMarker.setMap(null),customerMarker=new google.maps.Marker({map:map,position:e[0].geometry.location})):alert("Geocode was not successful for the following reason: "+o)})}function findClosestN(e,o){var a=[];return window.cinemalist_callback=function(o){for(var n=0;n<o.cinemas.length;n++)o.cinemas[n].distance=google.maps.geometry.spherical.computeDistanceBetween(e,o.cinemas[n].getPosition()),o.cinemas[n].setMap(null),a.push(o.cinemas[n])},a.sort(sortByDist),a.splice(0,o)}function sortByDist(e,o){return e.distance-o.distance}var map,geocoder=null,closest=[];$(document).ready(function(){google_map()});